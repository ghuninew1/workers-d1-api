<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000">
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/ghuninew1/ghuninew1/main/img/favicon.png" />
  <link rel="apple-touch-icon" type="image/x-icon"
    href="https://raw.githubusercontent.com/ghuninew1/ghuninew1/main/img/favicon.ico" />
  <link rel="manifest" href="https://raw.githubusercontent.com/ghuninew1/ghuninew1/main/img/manifest.json" />
  <title>GhuniNew</title>
  
  <!-- <script src="./js/react.production.min.js"></script>
  <script src="./js/react-dom.production.min.js"></script>
  <script src="./js/babel.min.js"></script>
  <script type="text/jsx" src="./js/main.jsx"></script>
  <link prefetch rel="stylesheet" href="./css/main.css"/> -->
  
</head>

<body>
  <div id="root"></div>

  
 
  <!-- <script>
    // const socket = new WebSocket("ws://localhost:8080");

    var ws;

    async function websocket( url ) {
      ws = new WebSocket( url )


      if ( !ws ) {
        return new Error( "server didn't accept ws" )
      }

      ws.addEventListener( "open", () => onOpen() );

      ws.addEventListener( "message", ( { data } ) => {

        const { count, tz, error, res, timeSent } = JSON.parse( data )
        addNewEvent( data )
        if ( error ) {
          setErrorMessage( error )
        } else {
          setErrorMessage()
          updateCount( count )
          getPing( data );
        }


      } )

      ws.addEventListener( "close", () => {
        console.log( 'Closed websocket' )

        const list = document.querySelector( "#events" )
        list.innerText = ""
        updateCount( 0 )
        setErrorMessage()
      } );


      document.querySelector( "#click" ).addEventListener( "click", () => {
        ws.send( "CLICK" )
      } );

      const closeConnection = () => {
        ws.close()
        onClose()
      }
      document.querySelector( "#close" ).addEventListener( "click", closeConnection )
      document.querySelector( "#unknown" ).addEventListener( "click", () => ws.send( "HUH" ) )

    }

    const url = new URL( window.location )
    url.protocol = location.protocol.replace( "http", "ws" )
    url.pathname = "/ws/"

    // const socket = new WebSocket( url )
    websocket( url )

    const onClose = () => {
      document.querySelector( "#status" ).classList.add( "offline" );
      document.querySelector( "#status" ).classList.remove( "online" );
      document.querySelector( "#ping" ).innerText = "Disconnected";
      console.log( 'Closed websocket' )
      const list = document.querySelector( "#events" )
      list.innerText = ""
      updateCount( 0 )
    }
    const onOpen = () => {

      document.querySelector( "#status" ).classList.add( "online" )
      document.querySelector( "#status" ).classList.remove( "offline" )
      document.querySelector( "#ping" ).innerText = "Connected"
      document.querySelector( "#date" ).innerHTML = new Date().toLocaleString( 'th' )
      document.querySelector( "#info" ).innerHTML = new Date().getMilliseconds() + " ms"
      console.log( "Connected to server" )
      updateCount( 0 )
      getLocation()
    }

    const updateCount = ( count ) => document.querySelector( "#num" ).innerText = `Count: ${ count }`;

    const addNewEvent = ( data ) => {
      const list = document.querySelector( "#events" )
      const item = document.createElement( "li" )
      item.innerText = data
      list.prepend( item )
    }
    const setErrorMessage = message => document.querySelector( "#error" ).innerHTML = message ? message : "";

    const getLocation = () => {
      if ( navigator.geolocation ) {
        navigator.geolocation.getCurrentPosition( ( position ) => {
          const { latitude, longitude } = position.coords;
          const location = { latitude, longitude };
          document.querySelector( "#location" ).innerText = `Lati: ${ latitude } :: Logi: ${ longitude }\n`;
        } );
      } else {
        document.querySelector( "#location" ).innerText = "Geolocation is not supported by this browser.";
      }
    }

    const getPing = ( data ) => {
      // const timeStart = new Date()
      const { tz, res } = JSON.parse( data )
      const end = res

      console.log( JSON.parse( data ) )
      return document.querySelector( "#info" ).innerText = `Ping: ${ end } ms`;
    }

  </script> -->
</body>

</html>